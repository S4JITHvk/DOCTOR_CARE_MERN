import{r as h,j as e}from"./index-DDg8tmzP.js";import{a as M,e as A}from"./adminService-Dh3wFakp.js";import{C as f,a as j,L as w,P as C,b as I,p as N,c as D,d as v,e as P,B as Y,h as y,f as S}from"./moment-Bg4gks8L.js";f.register(j,w,C,I,N,D,v);function B({appointments:b}){const[r,d]=h.useState("month"),n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=[...new Set(b.map(s=>new Date(s.date).getFullYear()))].sort((s,l)=>s-l),g={},m={};b.forEach(s=>{const l=new Date(s.date),t=l.getFullYear(),a=l.getMonth();g[t]||(g[t]=Array(12).fill(0)),g[t][a]+=1,m[t]||(m[t]=0),m[t]+=1});const i=Array(12).fill(0);Object.values(g).forEach(s=>{s.forEach((l,t)=>{i[t]+=l})});const u={labels:r==="month"?n:p,datasets:r==="month"?[{label:"Total Appointments by Month",data:i,borderColor:"rgba(255, 99, 132, 0.8)",backgroundColor:"rgba(255, 99, 132, 0.2)",fill:!1}]:[{label:"Total Appointments by Year",data:p.map(s=>m[s]),borderColor:"rgba(75, 192, 192, 0.8)",backgroundColor:"rgba(75, 192, 192, 0.2)",fill:!1}]},o={plugins:{legend:{labels:{color:"rgba(255, 255, 255, 0.8)"}},tooltip:{callbacks:{label:function(s){return r==="year"?[`Year ${s.label}: ${s.raw} appointments`]:`${n[s.dataIndex]}: ${s.raw} appointments`}}}},scales:{x:{ticks:{color:"rgba(255, 255, 255, 0.8)"},grid:{color:"rgba(255, 255, 255, 0.1)"},title:{display:!0,text:r==="month"?"Months":"Years",color:"rgba(255, 255, 255, 0.8)"}},y:{ticks:{color:"rgba(255, 255, 255, 0.8)"},grid:{color:"rgba(255, 255, 255, 0.1)"},title:{display:!0,text:"Appointments",color:"rgba(255, 255, 255, 0.8)"}}}};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("button",{className:`mr-2 px-4 py-2 rounded ${r==="month"?"bg-blue-500 text-white":"bg-gray-500 text-white"}`,onClick:()=>d("month"),children:"Month-wise"}),e.jsx("button",{className:`px-4 py-2 rounded ${r==="year"?"bg-blue-500 text-white":"bg-gray-500 text-white"}`,onClick:()=>d("year"),children:"Year-wise"})]}),e.jsxs("h2",{className:"text-xl mb-4 text-gray-300",children:["Total Appointments by ",r==="month"?"Month":"Year"]}),e.jsx(P,{data:u,options:o})]})}f.register(j,w,Y,N,D,v);function E({appointments:b}){const r=()=>{const i=[];for(let x=6;x>=0;x--)i.push(y().subtract(x,"days").format("YYYY-MM-DD"));return i},d=(i,x,u)=>r().map(s=>{let l=0;return i.forEach(t=>{y(t[x]).format(u)===s&&l++}),l}),n=r().map(i=>y(i).format("MM-DD")),p=d(b,"date","YYYY-MM-DD"),g={labels:n,datasets:[{label:"Appointments",data:p,backgroundColor:"rgba(57, 89, 255, 0.8)",borderColor:"rgba(54, 162, 235, 1)",borderWidth:1}]},m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{labels:{color:"rgba(255, 255, 255, 0.8)"}}},scales:{x:{ticks:{color:"rgba(255, 255, 255, 0.8)"},grid:{color:"rgba(255, 255, 255, 0.1)"}},y:{ticks:{color:"rgba(255, 255, 255, 0.8)"},grid:{color:"rgba(255, 255, 255, 0.1)"}}}};return e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-xl mb-2 text-gray-300",children:"Total Appointments by last week"}),e.jsx("div",{style:{height:"250px"},children:e.jsx(S,{data:g,options:m})})]})}function T({Appointments:b}){const[r,d]=h.useState([]),[n,p]=h.useState(null),[g,m]=h.useState([]);h.useEffect(()=>{const o=async()=>{const s=await M();s.status===200&&d(s.data.data)};m(b),o()},[b]);const i=o=>{p(o)},u=n?((o,s)=>{const l=o.filter(a=>a.status==="Completed"&&a.doctorId._id===s),t={};return l.forEach(a=>{const c=new Date(a.date).toLocaleString("default",{month:"long",year:"numeric"});t[c]||(t[c]=0),t[c]+=1}),t})(g,n._id):{};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-10",children:[e.jsxs("div",{className:"w-[100%] p-4 bg-gray-800 border-gray-600 rounded-lg overflow-y-auto",style:{maxHeight:"80vh"},children:[e.jsx("h2",{className:"text-xl text-white font-semibold mb-4",children:"Doctors List"}),e.jsx("ul",{className:"space-y-2",children:r.length&&(r==null?void 0:r.map(o=>e.jsxs("li",{className:`flex items-center p-2 border rounded cursor-pointer ${(n==null?void 0:n._id)===o._id?"bg-blue-500 text-white":"bg-gray-100"}`,onClick:()=>i(o),children:[e.jsx("img",{src:o.profile||"/assets/doctor.jpg",alt:`${o.name}'s profile`,className:"w-8 h-8 rounded-full mr-2"}),e.jsxs("span",{className:"text-sm",children:["DR ",o.name]})]},o._id)))})]}),e.jsxs("div",{className:"w-[100%] p-4 bg-gray-800 border-gray-600 rounded-lg overflow-y-auto",style:{maxHeight:"80vh"},children:[e.jsx("h2",{className:"text-xl text-white font-semibold mb-4",children:"Doctor Completed Bookings Per Month"}),n?e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg text-white font-semibold mb-2",children:["Doctor: ",n.name]}),e.jsx("ul",{className:"space-y-2",children:Object.keys(u).length>0?Object.entries(u).map(([o,s])=>e.jsxs("li",{className:"p-2 border rounded bg-gray-100",children:[o,": ",s," bookings"]},o)):e.jsx("li",{className:"p-2 border rounded bg-gray-100",children:"No completed bookings"})})]}):e.jsx("p",{className:"text-white",children:"Please select a doctor to view their completed bookings."})]})]})}function _(){const[b,r]=h.useState([]),[d,n]=h.useState([]),[p,g]=h.useState(0),[m,i]=h.useState(0);h.useEffect(()=>{(async()=>{const a=await A();if(a.status===200){n(a.data.bookings);const c=x(a.data.bookings);r(c),o(a.data.bookings),s(a.data.bookings)}})()},[]);const x=t=>{const a={};return t.forEach(c=>{a[c.userId.email]||(a[c.userId.email]=c.userId)}),Object.values(a)},u=[...d].sort((t,a)=>new Date(a.date)-new Date(t.date)).slice(0,10),o=t=>{const a=t.reduce((c,k)=>k.payment.status==="Paid"?c+499:c,0);g(a)},s=t=>{const a=t.length*499;i(a)},l=m!==0?(p/m*100).toFixed(2):0;return e.jsxs("div",{className:"container mx-auto py-6 px-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-gray-800 p-4 border border-gray-600 rounded-lg",children:e.jsx(B,{appointments:d})}),e.jsx("div",{className:"bg-gray-800 p-4 border border-gray-600 rounded-lg",children:e.jsx(E,{appointments:d})})]}),e.jsx(T,{Appointments:d}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-8",children:[e.jsxs("div",{className:"bg-gray-800 p-4 border border-gray-600 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Consulted Patients"}),e.jsx("ul",{className:"text-white overflow-y-auto",style:{maxHeight:"200px"},children:b.map(t=>e.jsxs("div",{className:"flex mt-2",children:[e.jsx("img",{src:t.profile||"/assets/user.png",alt:`${t.name}'s profile`,className:"w-8 h-8 rounded-full mr-2"}),e.jsx("li",{className:"border-b border-gray-700 py-1",children:t.name},t._id)]}))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 border border-gray-600 rounded-lg",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Latest Appointments"}),e.jsx("ul",{className:"text-white overflow-y-auto",style:{maxHeight:"200px"},children:u.map(t=>e.jsxs("li",{className:"border-b border-gray-700 py-1 text-sm",children:[new Date(t.date).toLocaleDateString()," -"," ",t.userId.name," with DR ",t.doctorId.name]},t._id))})]}),e.jsxs("div",{className:"bg-gray-800 p-4 border border-gray-600 rounded-lg flex flex-col items-center justify-center",children:[e.jsx("h2",{className:"text-lg font-semibold text-white",children:"Total Income"}),e.jsxs("div",{className:"text-white text-2xl mt-4",children:[p," INR"]}),e.jsxs("div",{className:"text-gray-400 text-sm mt-2",children:["Percentage of total: ",l,"%"]})]})]})]})}function O(){return e.jsx(e.Fragment,{children:e.jsx(_,{})})}export{O as default};
