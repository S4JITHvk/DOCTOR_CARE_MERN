import{b as le,c as O,r as t,j as e,_ as G,a as re,d as ne,L as ie,f as ce}from"./index-DDg8tmzP.js";import{M as oe,a as de,b as xe,c as me,d as ue}from"./index-C2XjEMwL.js";import{M as k}from"./index-XLCXBP2A.js";import{D as he}from"./react-datepicker-CpKRV2Wu.js";import{f as be,a as ge,d as pe,u as fe,b as je}from"./userService-B62CsAJS.js";import"./format-D5IGutSq.js";import"./floating-ui.react-SXetMiss.js";function ve(j){return le({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",strokeWidth:"2",d:"M3,3 L21,21 M3,21 L21,3"},child:[]}]})(j)}k.setAppElement("#root");function ye({isOpen:j,onClose:i,doctor:l}){var n,D;const m=O(a=>a.user),[o,N]=t.useState(""),[u,w]=t.useState([]);t.useEffect(()=>(d(),()=>{w([])}),[l==null?void 0:l._id]);const d=async()=>{const a=await be(l==null?void 0:l._id);(a==null?void 0:a.status)===200&&w(a.data)},E=a=>{N(a.target.value)},h=async()=>{var p;(await ge(o,(p=m.user)==null?void 0:p._id,l._id)).status===200&&(d(),G.success("Review Submitted"),N(""))},g=(n=u.reviews)==null?void 0:n.sort((a,p)=>new Date(p.timestamp)-new Date(a.timestamp));return e.jsx(k,{isOpen:j,onRequestClose:i,contentLabel:"Add Review Modal",className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:l&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-[600px]",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("img",{src:l.profile||"/assets/doc.png",alt:"Doctor Profile",className:"w-16 h-16 rounded-full mr-4"}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-blue-800",children:["DR ",l.name]}),e.jsxs("p",{className:"text-gray-700",children:["EXPERTISE: ",l.expertise]}),e.jsxs("p",{className:"text-gray-500",children:["EXPERIENCE: ",l.experience_years," years"]}),e.jsxs("p",{className:"text-gray-500",children:["GENDER: ",l.gender]})]})]}),e.jsx("button",{onClick:i,className:"text-gray-500 hover:text-gray-700",children:e.jsx(ve,{size:24})})]}),e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-1/2 pr-2 border-r",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-blue-800",children:"Add Review"}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:((D=m.user)==null?void 0:D.profile)||"/assets/user.png",alt:"User Profile",className:"w-10 h-10 rounded-full mr-4"}),e.jsx("textarea",{value:o,onChange:E,className:"w-full h-24 p-2 border border-gray-300 rounded focus:ring focus:ring-blue-300",placeholder:"Add your review here..."})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:h,className:`px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700 ${o.trim()===""?"opacity-50 cursor-not-allowed":""}`,disabled:o.trim()==="",children:"Submit"})})]}),e.jsxs("div",{className:"w-1/2 pl-2 overflow-y-auto",style:{maxHeight:"300px"},children:[e.jsx("h3",{className:"text-lg font-semibold mb-4 text-blue-800",children:"View Reviews"}),e.jsx("div",{className:"space-y-4",children:(g==null?void 0:g.length)>0?g.map(a=>e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("img",{src:a.userId.profile||"/assets/user.png",alt:"User Profile",className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:a.userId.name}),e.jsx("p",{className:"text-gray-700",children:a.comment})]})]},a._id)):e.jsx("p",{className:"text-gray-500",children:"No reviews"})})]})]})]})})}k.setAppElement("#root");function Re(){const j=re(),i=O(s=>s.user),l=ne(),{Doctor:m}=j.state||{},[o,N]=t.useState([]),[u,w]=t.useState(""),[d,E]=t.useState(""),[h,g]=t.useState(""),[n,D]=t.useState(1),[a,p]=t.useState(1),[T]=t.useState(9),[X,C]=t.useState(!1),[U,I]=t.useState(!1),[x,v]=t.useState(null),[R,_]=t.useState(""),M=new Date;M.setDate(M.getDate()+1);const[y,$]=t.useState(M),[q,K]=t.useState([]),[Q,z]=t.useState([]),[H,A]=t.useState([]),V=["9am-10am","11am-12pm","2pm-3pm","5pm-6pm","8pm-9pm"];t.useEffect(()=>{W()},[n,u,d,h]),t.useEffect(()=>{var s;(s=i==null?void 0:i.user)!=null&&s.favoriteDoctors&&A(i.user.favoriteDoctors)},[i]),t.useEffect(()=>{(async()=>{m&&(v(m),await F(m._id),C(!0))})()},[m]);const W=async()=>{const r=await pe({currentPage:n,itemsPerPage:T,experienceFilter:u,genderFilter:d,searchQuery:h});N(r.data.Doctors),p(r.data.totalPages)},F=async s=>{const r=await fe(s),f=r.data.List.map(b=>({...b,date:new Date(b.date)}));K(f),z(r.data.Slots)},P=s=>{D(s)},J=async s=>{v(s),await F(s._id),C(!0)},Y=async s=>{v(s),I(!0)},S=()=>{C(!1),v(null),_("")},Z=()=>{I(!1),v(null)},ee=s=>{_(s)},se=s=>{$(new Date(s)),_("")},te=async s=>{var f,b;const r=await je(s,(f=i.user)==null?void 0:f._id);r.status===200&&(A(c=>c.includes(s._id)?c.filter(ae=>ae!==s._id):[...c,s._id]),ce(l),G.success((b=r.data)==null?void 0:b.message))},B=o==null?void 0:o.filter(s=>(u===""||s.experience_years.toString()===u)&&(d===""||s.gender===d)&&(h===""||s.name.toLowerCase().includes(h.toLowerCase()))),L=(s,r)=>{const f=q.some(c=>new Date(c.date).toDateString()===r.toDateString()&&c.shift===s),b=Q.some(c=>new Date(c.date).toDateString()===r.toDateString()&&c.shifts.includes(s));return f||b};return e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1/4 p-6 bg-gray-100 h-screen sticky top-0",children:e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4 text-blue-800",children:"Filters"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Experience"}),e.jsxs("select",{value:u,onChange:s=>w(s.target.value),className:"w-full p-2 border border-gray-300 rounded focus:ring focus:ring-blue-300",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"2",children:"2 years"}),e.jsx("option",{value:"5",children:"5 years"}),e.jsx("option",{value:"8",children:"8 years"}),e.jsx("option",{value:"10",children:"10 years"}),e.jsx("option",{value:"12",children:"12 years"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Gender"}),e.jsxs("select",{value:d,onChange:s=>E(s.target.value),className:"w-full p-2 border border-gray-300 rounded focus:ring focus:ring-blue-300",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Search"}),e.jsx("input",{type:"text",value:h,onChange:s=>g(s.target.value),className:"w-full p-2 border border-gray-300 rounded focus:ring focus:ring-blue-300",placeholder:"Search by name"})]})]})}),e.jsxs("div",{className:"w-3/4 p-6",children:[e.jsx("div",{className:"flex flex-wrap gap-6",children:B==null?void 0:B.map(s=>e.jsxs("div",{className:"w-64 p-4 bg-white border border-gray-200 rounded-lg shadow-md hover:shadow-lg transition-shadow duration-300",children:[e.jsx("img",{src:s.profile||"/assets/doc.png",alt:s.name,className:"w-full h-40 object-cover rounded-t-lg"}),e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-blue-800",children:["DR ",s.name]}),e.jsxs("p",{className:"text-gray-700",children:["EXPERTISE : ",s.expertise]}),e.jsxs("p",{className:"text-gray-500",children:["EXPERIENCE : ",s.experience_years," years"]}),e.jsxs("p",{className:"text-gray-500",children:["GENDER : ",s.gender]}),e.jsxs("div",{className:"flex justify-between mt-4",children:[e.jsx("button",{onClick:()=>Y(s),className:"px-3 py-2 bg-black text-white rounded hover:bg-blue-700",children:e.jsx(oe,{})}),e.jsx("button",{onClick:()=>te(s),className:"px-3 py-2 bg-black text-white rounded hover:bg-blue-700 flex items-center",children:H.includes(s._id)?e.jsx(de,{className:"text-red-500"}):e.jsx(xe,{})}),e.jsx("button",{onClick:()=>J(s),className:"px-3 py-2 bg-black text-white rounded hover:bg-blue-700",children:"Book Slot"})]})]})]},s._id))}),e.jsxs("div",{className:"mt-6 flex justify-center",children:[e.jsx("button",{onClick:()=>P(n-1),disabled:n===1,className:"px-4 py-2 mx-1 bg-blue-500 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:e.jsx(me,{})}),[...Array(a).keys()].map(s=>e.jsx("button",{onClick:()=>P(s+1),className:`px-4 py-2 mx-1 ${n===s+1?"bg-blue-700":"bg-blue-500"} text-white rounded hover:bg-blue-700`,children:s+1},s+1)),e.jsx("button",{onClick:()=>P(n+1),disabled:n===a,className:"px-4 py-2 mx-1 bg-blue-500 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:e.jsx(ue,{})})]})]}),e.jsx(k,{isOpen:X,onRequestClose:S,contentLabel:"Book Slot Modal",className:"fixed inset-0 flex items-center justify-center p-4 bg-black bg-opacity-50",overlayClassName:"fixed inset-0 bg-black bg-opacity-50",children:x&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-96",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4 text-blue-800",children:"Book Slot"}),e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx("img",{src:x.profile||"/assets/doc.png",alt:"Doctor Profile",className:"w-12 h-12 rounded-full mr-4"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["DR ",x.name]}),e.jsxs("p",{className:"text-gray-700",children:["EXPERTISE: ",x.expertise]}),e.jsxs("p",{className:"text-gray-500",children:["EXPERIENCE: ",x.experience_years," years"]}),e.jsxs("p",{className:"text-gray-500",children:["GENDER: ",x.gender]})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Select Date"}),e.jsx(he,{selected:y,onChange:se,minDate:new Date(Date.now()+24*60*60*1e3),maxDate:new Date(Date.now()+6*24*60*60*1e3),className:"w-full p-2 border border-gray-300 rounded focus:ring focus:ring-blue-300"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Available Shifts"}),e.jsx("div",{className:"grid grid-cols-2 gap-4",children:V.map(s=>e.jsx("button",{onClick:()=>ee(s),className:`p-2 border rounded ${L(s,y)?"border-red-500 text-red-500 cursor-not-allowed":R===s?"border-green-500 text-green-500":"border-green-500"}`,disabled:L(s,y),title:L(s,y)?"Slot not available":"Slot available",children:s},s))})]}),e.jsxs("div",{className:"flex justify-end",children:[e.jsx("button",{onClick:S,className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-700 mr-2",children:"Cancel"}),R?e.jsx(ie,{to:"/Payment_process",state:{selectedDoctor:x,selectedDate:y,selectedShift:R},children:e.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700",children:"Book"})}):e.jsx("button",{onClick:S,className:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-700 opacity-50 cursor-not-allowed",disabled:!0,children:"Book"})]})]})}),e.jsx(ye,{isOpen:U,onClose:Z,doctor:x})]})}export{Re as default};
