import{r as d,c as f,_ as c,j as e,L as j}from"./index-DDg8tmzP.js";import{S as y}from"./sweetalert2.all-BcwuNuaI.js";import{D as N}from"./react-datepicker-CpKRV2Wu.js";import{b as w,c as g}from"./doctorService-BeaFpf1z.js";import"./format-D5IGutSq.js";import"./floating-ui.react-SXetMiss.js";const D={"9am-10am":9,"11am-12pm":11,"2pm-3pm":14,"5pm-6pm":17,"8pm-9pm":20};function B(){const[l,o]=d.useState([]),[r,u]=d.useState(new Date),i=f(t=>t.doctor);d.useEffect(()=>{m(r)},[r]);const m=async t=>{const n=i.doctor._id,a=t.toISOString().split("T")[0],s=await w(a,n);s.status===200?(s.data.appointments.length===0&&(c.error("No appointments found"),o([])),o(s.data.appointments)):(c.error(s.data.message),o([]))},b=async t=>{(await y.fire({title:"Are you sure?",text:"Cancel this appointment.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, cancel it!"})).isConfirmed&&((await g(t)).status===200?(c.success("Appointment canceled successfully"),m(r)):c.error("Failed to cancel appointment"))},x=(t,n)=>{const a=new Date,s=new Date(t),p=D[n];if(p===void 0)return!1;const h=new Date(s);return h.setHours(p,0,0,0),s.toDateString()===a.toDateString()?h-a>60*60*1e3:!0};return e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Appointments"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"font-bold",children:"Filter by date - "}),e.jsx(N,{selected:r,onChange:t=>u(t),className:"border rounded px-3 py-2",dateFormat:"yyyy-MM-dd",minDate:new Date(i.doctor.createdAt)})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full bg-white",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-2 px-3 border-b",children:"Patient Name"}),e.jsx("th",{className:"py-2 px-3 border-b",children:"Email"}),e.jsx("th",{className:"py-2 px-3 border-b",children:"Booking Date"}),e.jsx("th",{className:"py-2 px-3 border-b",children:"Status"}),e.jsx("th",{className:"py-2 px-3 border-b",children:"Time"}),e.jsx("th",{className:"py-2 px-3 border-b",children:"Actions"})]})}),e.jsx("tbody",{children:l.length>0?l.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"py-2 px-6 border-b",children:t.userId.name}),e.jsx("td",{className:"py-2 px-6 border-b",children:t.userId.email}),e.jsx("td",{className:"py-2 px-6 border-b",children:new Date(t.date).toLocaleDateString()}),e.jsx("td",{className:"py-2 px-6 border-b",children:t.status}),e.jsx("td",{className:"py-2 px-6 border-b",children:t.shift}),e.jsx("td",{className:"py-2 px-6 border-b",children:t.status==="Cancelled"?e.jsx("button",{className:"bg-gray-300 text-gray-700 w-[110px] ml-10 px-4 py-2 rounded cursor-not-allowed",disabled:!0,children:"Cancelled"}):t.status==="Completed"?e.jsx("button",{className:"bg-green-500 text-white px-4 py-2 w-[110px] ml-10 rounded cursor-not-allowed",disabled:!0,children:"Completed"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mr-2 w-[100px]",children:e.jsx(j,{to:"/doctor/Communicate",state:{data:t},children:"Intake"})}),e.jsx("button",{onClick:()=>b(t._id),className:`px-4 py-2 rounded w-[100px] ${x(t.date,t.shift)?"bg-red-500 text-white":"bg-gray-300 text-gray-700 cursor-not-allowed"}`,disabled:!x(t.date,t.shift),children:"Cancel"})]})})]},t._id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"text-center py-4",children:"No appointments found"})})})]})})]})}export{B as default};
